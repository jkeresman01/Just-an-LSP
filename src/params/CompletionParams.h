#pragma once

#include <nlohmann/json.hpp>
#include <string>

#include "../types/CompletionContext.h"
#include "../types/Range.h"
#include "../types/TextDocumentIdentifier.h"

namespace justanlsp
{
class CompletionParams
{
  public:
    //////////////////////////////////////////////////////////////
    ///
    /// @brief Constructs the Completion request from JSON RPC
    ///
    /// @param jsonRPC
    ///
    //////////////////////////////////////////////////////////////
    explicit CompletionParams(const nlohmann::json &jsonRPC);

    //////////////////////////////////////////////////////////////
    ///
    /// @brief Accessor method for text document URI on which
    ///        completion is requested
    ///
    //////////////////////////////////////////////////////////////
    Position getPosition() const { return m_position; };

    //////////////////////////////////////////////////////////////
    ///
    /// @brief Accessor method for text document URI on which
    ///        completion is requested
    ///
    //////////////////////////////////////////////////////////////
    std::string getURI() const { return m_textDocumentIdentifier.URI; }

  private:
    //////////////////////////////////////////////////////////////
    ///
    /// @brief Mutator method for text document context
    ///
    //////////////////////////////////////////////////////////////
    void setCompletionContext(const nlohmann::json &jsonRPC);

    //////////////////////////////////////////////////////////////
    ///
    /// @brief Mutator method for text document range
    ///
    //////////////////////////////////////////////////////////////
    void setPosition(const nlohmann::json &jsonRPC);

    //////////////////////////////////////////////////////////////
    ///
    /// @brief Mutator method for text document identifier
    ///
    //////////////////////////////////////////////////////////////
    void setTextDocumentIdentifier(const nlohmann::json &jsonRPC);

  private:
    //////////////////////////////////////////////////////////////
    ///
    /// @brief Completion context
    ///
    //////////////////////////////////////////////////////////////
    CompletionContext m_completionContext;

    //////////////////////////////////////////////////////////////
    ///
    /// @brief Position
    ///
    //////////////////////////////////////////////////////////////
    Position m_position;

    //////////////////////////////////////////////////////////////
    ///
    /// @brief text document identifier
    ///
    //////////////////////////////////////////////////////////////
    TextDocumentIdentifier m_textDocumentIdentifier;
};
} // namespace justanlsp
